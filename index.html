<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="description" content="ONE CHOICE: LIFE COLLAPSE - –ü—Å–∏—Ö–æ–ª–æ–≥–∏—á–µ—Å–∫–∞—è –∏–≥—Ä–∞-–≤—ã–±–æ—Ä">
    <meta http-equiv="Permissions-Policy" content="unload=(), beforeunload=()">
    <title>ONE CHOICE: LIFE COLLAPSE</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <!-- –ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é -->
    <div id="main-menu">
        <div class="menu-background">
            <div id="background-phrase" class="background-phrase"></div>
        </div>
        <div class="menu-content">
            <div class="menu-title">
                <h1>ONE CHOICE</h1>
                <h2>LIFE COLLAPSE</h2>
                <p class="subtitle" id="menu-subtitle">–ö–∞–∂–¥–æ–µ —Ä–µ—à–µ–Ω–∏–µ —á—Ç–æ-—Ç–æ –ª–æ–º–∞–µ—Ç.</p>
            </div>
            
            <div class="menu-buttons">
                <button id="start-btn" class="primary-btn">–ù–ê–ß–ê–¢–¨</button>
                <div id="returning-player-info" class="returning-info hidden"></div>
                
                <div id="daily-banner" class="daily-banner hidden">
                    <span id="daily-banner-text"></span>
                </div>
                
                <div class="secondary-buttons">
                    <button id="difficulty-btn" class="secondary-btn"><span id="difficulty-btn-text">–°–ª–æ–∂–Ω–æ—Å—Ç—å</span></button>
                    <button id="stats-btn" class="secondary-btn"><span id="stats-btn-text">–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</span></button>
                    <button id="endings-btn" class="secondary-btn"><span id="endings-btn-text">–ö–æ–Ω—Ü–æ–≤–∫–∏</span></button>
                    <button id="sound-menu-btn" class="secondary-btn"><span id="sound-btn-text">–ó–≤—É–∫</span>: <span id="sound-status">–í–ö–õ</span></button>
                    <button id="language-btn" class="secondary-btn"><span id="language-btn-text">–Ø–∑—ã–∫</span></button>
                </div>
                
                <div class="insight-display">
                    <span id="insight-label">–û–°–û–ó–ù–ê–ù–ò–ï:</span>
                    <span id="insight-value">0</span>
                </div>
            </div>
        </div>
    </div>

    <!-- –≠–∫—Ä–∞–Ω –≤—ã–±–æ—Ä–∞ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏ -->
    <div id="difficulty-screen" class="hidden">
        <div class="screen-content">
            <h2>–°–ª–æ–∂–Ω–æ—Å—Ç—å</h2>
            <div class="difficulty-options">
                <button class="difficulty-option" data-difficulty="easy">
                    <div class="difficulty-title">–õ–Å–ì–ö–û</div>
                    <div class="difficulty-desc">–ú–µ–Ω—å—à–µ –¥–∞–≤–ª–µ–Ω–∏—è.<br>–ë–æ–ª—å—à–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞ –¥–ª—è –æ—à–∏–±–æ–∫.</div>
                </button>
                <button class="difficulty-option active" data-difficulty="normal">
                    <div class="difficulty-title">–ù–û–†–ú–ê–õ–¨–ù–û</div>
                    <div class="difficulty-desc">–ö–∞–∫ –∑–∞–¥—É–º–∞–Ω–æ.<br>–û—à–∏–±–∫–∏ –∏–º–µ—é—Ç —Ü–µ–Ω—É.</div>
                </button>
                <button class="difficulty-option" data-difficulty="hard">
                    <div class="difficulty-title">–ñ–Å–°–¢–ö–û</div>
                    <div class="difficulty-desc">–ë—ã—Å—Ç—Ä–æ.<br>–ë–æ–ª—å–Ω–æ.<br>–ë–µ–∑ –ø—Ä–∞–≤–∞ –Ω–∞ –æ—à–∏–±–∫—É.</div>
                </button>
            </div>
            <button id="difficulty-back-btn" class="back-btn">–ù–∞–∑–∞–¥</button>
        </div>
    </div>

    <!-- –≠–∫—Ä–∞–Ω —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ -->
    <div id="stats-screen" class="hidden">
        <div class="screen-content">
            <h2 id="stats-title">–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</h2>
            <div class="stats-content">
                <div class="stat-item">
                    <span class="stat-label" id="stats-total-runs">–í—Å–µ–≥–æ –∑–∞–ø—É—Å–∫–æ–≤:</span>
                    <span id="total-runs" class="stat-value">0</span>
                </div>
                <div class="stat-item">
                    <span class="stat-label" id="stats-best-result">–õ—É—á—à–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:</span>
                    <span id="best-result" class="stat-value">0 —Ä–µ—à–µ–Ω–∏–π</span>
                </div>
                <div class="stat-item">
                    <span class="stat-label" id="stats-common-failure">–ß–∞—Å—Ç–∞—è –ø—Ä–∏—á–∏–Ω–∞ –ø—Ä–æ–≤–∞–ª–∞:</span>
                    <span id="common-failure" class="stat-value">‚Äî</span>
                </div>
                <div class="stat-item">
                    <span class="stat-label" id="stats-last-difficulty">–ü–æ—Å–ª–µ–¥–Ω—è—è —Å–ª–æ–∂–Ω–æ—Å—Ç—å:</span>
                    <span id="last-difficulty" class="stat-value">–ù–û–†–ú–ê–õ–¨–ù–û</span>
                </div>
                <div class="stat-item">
                    <span class="stat-label" id="stats-unlocked-endings">–†–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ –∫–æ–Ω—Ü–æ–≤–æ–∫:</span>
                    <span id="unlocked-endings-count" class="stat-value">0</span>
                </div>
            </div>
            <button id="stats-back-btn" class="back-btn" data-text="–ù–∞–∑–∞–¥">–ù–∞–∑–∞–¥</button>
        </div>
    </div>

    <!-- –≠–∫—Ä–∞–Ω –∫–æ–Ω—Ü–æ–≤–æ–∫ -->
    <div id="endings-screen" class="hidden">
        <div class="screen-content endings-screen-content">
            <div class="endings-header">
                <h2 id="endings-title">–ö–æ–Ω—Ü–æ–≤–∫–∏</h2>
                <button id="endings-back-btn" class="back-btn" data-text="–ù–∞–∑–∞–¥">–ù–∞–∑–∞–¥</button>
            </div>
            <div id="endings-list-container" class="endings-list-container">
                <div id="endings-list" class="endings-list"></div>
            </div>
        </div>
    </div>

    <!-- –≠–∫—Ä–∞–Ω –≤—ã–±–æ—Ä–∞ —è–∑—ã–∫–∞ -->
    <div id="language-screen" class="hidden">
        <div class="screen-content">
            <h2 id="language-title">–Ø–∑—ã–∫</h2>
            <div class="language-options">
                <button class="language-option active" data-language="ru">
                    <div class="language-name">–†—É—Å—Å–∫–∏–π</div>
                </button>
                <button class="language-option" data-language="en">
                    <div class="language-name">English</div>
                </button>
            </div>
            <button id="language-back-btn" class="back-btn" data-text="–ù–∞–∑–∞–¥">–ù–∞–∑–∞–¥</button>
        </div>
    </div>

    <!-- –≠–∫—Ä–∞–Ω –ø–µ—Ä–≤–æ–≥–æ –∑–∞–ø—É—Å–∫–∞ -->
    <div id="first-time-message" class="hidden">
        <div class="message-content">
            <p id="first-time-quote">–•–æ—Ä–æ—à–∏—Ö —Ä–µ—à–µ–Ω–∏–π –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç.</p>
        </div>
    </div>

    <!-- –ú–æ–¥–∏—Ñ–∏–∫–∞—Ç–æ—Ä –ø–µ—Ä–µ–¥ –∑–∞–ø—É—Å–∫–æ–º -->
    <div id="modifier-announcement" class="hidden">
        <div class="modifier-content">
            <h3 id="modifier-title">–ê–∫—Ç–∏–≤–Ω—ã–π –º–æ–¥–∏—Ñ–∏–∫–∞—Ç–æ—Ä</h3>
            <div id="modifier-name" class="modifier-name"></div>
            <div id="modifier-description" class="modifier-description"></div>
            <button id="modifier-continue-btn" class="primary-btn" data-text="–ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å">–ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å</button>
        </div>
    </div>

    <div id="game-container" class="hidden">
        <!-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ -->
        <div id="stats-panel">
            <div class="stat-bar-container">
                <div class="stat-label">–†–∞–∑—É–º</div>
                <div class="stat-bar">
                    <div id="stat-mind" class="stat-fill" data-stat="mind" style="width: 100%;"></div>
                </div>
                <span class="stat-value" id="value-mind">100</span>
            </div>
            <div class="stat-bar-container">
                <div class="stat-label">–°–µ—Ä–¥—Ü–µ</div>
                <div class="stat-bar">
                    <div id="stat-heart" class="stat-fill" data-stat="heart" style="width: 100%;"></div>
                </div>
                <span class="stat-value" id="value-heart">100</span>
            </div>
            <div class="stat-bar-container">
                <div class="stat-label">–í—Ä–µ–º—è</div>
                <div class="stat-bar">
                    <div id="stat-time" class="stat-fill" data-stat="time" style="width: 100%;"></div>
                </div>
                <span class="stat-value" id="value-time">100</span>
            </div>
            <div class="stat-bar-container">
                <div class="stat-label">–î–≤–∏–∂–µ–Ω–∏–µ</div>
                <div class="stat-bar">
                    <div id="stat-drive" class="stat-fill" data-stat="drive" style="width: 100%;"></div>
                </div>
                <span class="stat-value" id="value-drive">100</span>
            </div>
        </div>

        <!-- –ò–≥—Ä–æ–≤–∞—è –æ–±–ª–∞—Å—Ç—å -->
        <div id="game-area">
            <div id="situation-text"></div>
            <div id="choices-container">
                <button class="choice-btn" id="choice-1"></button>
                <button class="choice-btn" id="choice-2"></button>
            </div>
        </div>

        <!-- –°—á–µ—Ç—á–∏–∫ —Ä–µ—à–µ–Ω–∏–π -->
        <div id="progress-info">
            <span id="choices-count">–†–µ—à–µ–Ω–∏–π: 0</span>
            <span id="score-display">–°—á–µ—Ç: 0</span>
        </div>

        <!-- –ù–∞—Å—Ç—Ä–æ–π–∫–∏ -->
        <div id="settings-panel">
            <button id="sound-toggle" class="icon-btn" title="–ó–≤—É–∫">üîä</button>
        </div>
    </div>

    <!-- –≠–∫—Ä–∞–Ω –æ–∫–æ–Ω—á–∞–Ω–∏—è –∏–≥—Ä—ã -->
    <div id="game-over-screen" class="hidden">
        <div class="game-over-content">
            <h1>–ö–û–õ–õ–ê–ü–°</h1>
            <div id="collapse-reason"></div>
            <div class="stats-summary">
                <div class="summary-item">
                    <span class="summary-label" id="final-score-label">–°—á–µ—Ç:</span>
                    <span id="final-score">0</span>
                </div>
                <div class="summary-item">
                    <span class="summary-label" id="final-choices-label">–†–µ—à–µ–Ω–∏–π:</span>
                    <span id="final-choices">0</span>
                </div>
                <div class="summary-item">
                    <span class="summary-label" id="percentile-label">–í—ã–∂–∏–ª–∏ –¥–æ–ª—å—à–µ:</span>
                    <span id="percentile">0%</span>
                </div>
            </div>
            <div id="ending-type"></div>
            <div id="insight-earned" class="insight-earned hidden">
                <span id="insight-earned-label">–ü–æ–ª—É—á–µ–Ω–æ –û–°–û–ó–ù–ê–ù–ò–ï:</span>
                <span id="insight-earned-value">0</span>
            </div>
            <div class="game-over-buttons">
                <button id="revive-ad-btn" class="action-btn" data-text="–í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å (–†–µ–∫–ª–∞–º–∞)">–í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å (–†–µ–∫–ª–∞–º–∞)</button>
                <button id="restart-btn" class="action-btn" data-text="–í –º–µ–Ω—é">–í –º–µ–Ω—é</button>
            </div>
            <div id="restart-quote" class="restart-quote"></div>
        </div>
    </div>


    <!-- –ò–≥—Ä–æ–≤—ã–µ –º–æ–¥—É–ª–∏ (–∑–∞–≥—Ä—É–∂–∞–µ–º –¥–æ SDK) -->
    <script src="engine/stats.js"></script>
    <script src="engine/sceneManager.js"></script>
    <script src="engine/environmentDetector.js"></script>
    <script src="engine/adManager.js"></script>
    <script src="engine/insightManager.js"></script>
    <script src="engine/modifierManager.js"></script>
    <script src="engine/endingsManager.js"></script>
    <script src="engine/dailyRunManager.js"></script>
    <script src="engine/quotesManager.js"></script>
    <script src="engine/languageManager.js"></script>
    
    <!-- Yandex Games SDK (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –¥–æ—Å—Ç—É–ø–µ–Ω) -->
    <script>
        // –ë–µ–∑–æ–ø–∞—Å–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ SDK —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –º—ã –≤ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–º –æ–∫—Ä—É–∂–µ–Ω–∏–∏
        (function() {
            try {
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –º—ã –≤ iframe –∏ –µ—Å—Ç—å parent
                var isInIframe = window.self !== window.top;
                var hasParent = window.parent && window.parent !== window;
                
                // –ó–∞–≥—Ä—É–∂–∞–µ–º SDK —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –µ—Å—Ç—å –ø—Ä–∏–∑–Ω–∞–∫–∏ Yandex Games –æ–∫—Ä—É–∂–µ–Ω–∏—è
                if (isInIframe && hasParent && (window.location.search.includes('appId') || typeof YaGames !== 'undefined')) {
                    var script = document.createElement('script');
                    script.src = 'https://yandex.ru/games/sdk/v2';
                    script.async = true;
                    script.onerror = function() {
                        // –ú–æ–ª—á–∞ –∏–≥–Ω–æ—Ä–∏—Ä—É–µ–º –æ—à–∏–±–∫–∏ –∑–∞–≥—Ä—É–∑–∫–∏
                    };
                    script.onload = function() {
                        // SDK –∑–∞–≥—Ä—É–∂–µ–Ω —É—Å–ø–µ—à–Ω–æ
                    };
                    document.head.appendChild(script);
                }
            } catch (e) {
                // –ú–æ–ª—á–∞ –∏–≥–Ω–æ—Ä–∏—Ä—É–µ–º –≤—Å–µ –æ—à–∏–±–∫–∏
            }
        })();
        
        // –ü–æ–¥–∞–≤–ª–µ–Ω–∏–µ –æ—à–∏–±–æ–∫ –æ—Ç —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–π –±—Ä–∞—É–∑–µ—Ä–∞ (–≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –î–û –∑–∞–≥—Ä—É–∑–∫–∏ –¥—Ä—É–≥–∏—Ö —Å–∫—Ä–∏–ø—Ç–æ–≤)
        (function() {
            var originalError = console.error;
            var originalWarn = console.warn;
            var originalLog = console.log;
            
            // –§—É–Ω–∫—Ü–∏—è –ø—Ä–æ–≤–µ—Ä–∫–∏, –Ω—É–∂–Ω–æ –ª–∏ –∏–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ
            function shouldIgnoreMessage(message) {
                if (typeof message !== 'string') {
                    message = String(message);
                }
                
                return message.includes('csspeeper') ||
                    message.includes('inspector') ||
                    message.includes('payload') ||
                    message.includes('Ad unit initialization failed') ||
                    message.includes('Permissions policy violation') ||
                    message.includes('Permissions policy') ||
                    message.includes('unload') ||
                    message.includes('beforeunload') ||
                    message.includes('VM') ||
                    message.includes('[Violation]') ||
                    message.includes('inspector.b9415ea5');
            }
            
            console.error = function() {
                var args = Array.prototype.slice.call(arguments);
                var message = args.map(function(arg) {
                    return typeof arg === 'string' ? arg : JSON.stringify(arg);
                }).join(' ');
                
                if (shouldIgnoreMessage(message)) {
                    return;
                }
                
                originalError.apply(console, args);
            };
            
            console.warn = function() {
                var args = Array.prototype.slice.call(arguments);
                var message = args.map(function(arg) {
                    return typeof arg === 'string' ? arg : JSON.stringify(arg);
                }).join(' ');
                
                if (shouldIgnoreMessage(message)) {
                    return;
                }
                
                originalWarn.apply(console, args);
            };
            
            // –¢–∞–∫–∂–µ —Ñ–∏–ª—å—Ç—Ä—É–µ–º console.log –¥–ª—è VM —Å–∫—Ä–∏–ø—Ç–æ–≤
            console.log = function() {
                var args = Array.prototype.slice.call(arguments);
                var message = args.map(function(arg) {
                    return typeof arg === 'string' ? arg : JSON.stringify(arg);
                }).join(' ');
                
                if (shouldIgnoreMessage(message)) {
                    return;
                }
                
                originalLog.apply(console, args);
            };
        })();
    </script>
    
    <!-- –û—Å–Ω–æ–≤–Ω–æ–π –∏–≥—Ä–æ–≤–æ–π —Ñ–∞–π–ª -->
    <script src="main.js"></script>
</body>
</html>

